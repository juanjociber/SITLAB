<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>GPEM S.A.C</title>

    <!-- Custom fonts for this template-->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="css/sb-admin-2.css" rel="stylesheet">
    <style>
        body{
            font-family: 'Roboto',sans-serif;
            font-size: 17px;
        }
        .fa, .fas{
            color: #FFFFFF;
        }
        h1{
            color: #505cfd;
        }
    </style>
</head>

<body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

            <!-- Sidebar - Brand -->
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
              <div class="sidebar-brand-icon rotate-n-15">
                <!-- <i class="fas fa-laugh-wink"></i> -->
              </div>
              <div class="sidebar-brand-text mx-3">SITLAP - Lima Aiport Partners</div>
            </a>

            <!-- Divider -->
            <hr class="sidebar-divider my-0">

            <!-- Nav Item - Dashboard -->
            <li class="nav-item active">
                <a class="nav-link" href="index.html">
                  <i class="fas fa-fw fa-tachometer-alt"></i>
                  <span>Dashboard</span></a>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Nav Item - Pages Collapse Menu -->
            <li class="nav-item">
            <a class="nav-link" href="control-asistencia.html">
                <i class="fas fa-user"></i>
                <span>Control de asistencia</span></a>
            </li>

            <!-- Nav Item - Utilities Collapse Menu -->
            <li class="nav-item">
            <a class="nav-link" href="control-activo.html">
                <i class="fas fa-clock"></i>
                <span>Control de activo</span></a>
            </li>

            <!-- Nav Item - Pages Collapse Menu -->
            <li class="nav-item">
            <a class="nav-link" href="regitro-hallazgo.html">
                <i class="fas fa-object-ungroup"></i>
                <span>Registro de hallazgo</span></a>
            </li>

            <!-- Nav Item - Charts -->
            <li class="nav-item">
            <a class="nav-link" href="registro-incidencia.html">
                <i class="fas fa-object-ungroup"></i>
                <span>Registro de incidencias</span></a>
            </li>

            <!-- Nav Item - Tables -->
            <li class="nav-item">
                <a class="nav-link" href="informe-entregable.html">
                    <i class="fas fa-fw fa-table"></i>
                    <span>Informes / Entregables</span></a>
            </li>

            <!-- Nav Item - Programación de operación -->
            <li class="nav-item">
            <a class="nav-link" href="programacion-conductor.html">
                <i class="fas fa-fw fa-table"></i>
                <span>Programación de conductor</span></a>
            </li>

            <!-- Nav Item - Registro de activos -->
            <li class="nav-item">
            <a class="nav-link" href="registro-activos.html">
                <i class="fas fa-fw fa-table"></i>
                <span>Registro de activos</span></a>
            </li>

            <!-- Nav Item - Programación de manteniemiento -->
            <li class="nav-item">
            <a class="nav-link" href="programacion-mantenimiento.html">
                <i class="fas fa-fw fa-table"></i>
                <span>Programación mantenimiento</span></a>
            </li>

            <!-- Nav Item - Registro de amonestaciones -->
            <li class="nav-item">
            <a class="nav-link" href="registro-amonestaciones.html">
                <i class="fas fa-fw fa-table"></i>
                <span>Registro de amonestaciones</span></a>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider d-none d-md-block">

            <!-- Sidebar Toggler (Sidebar) -->
            <div class="text-center d-none d-md-inline">
                <button class="rounded-circle border-0" id="sidebarToggle"></button>
            </div>

        </ul>
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Topbar -->
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow" style="background-color: #0061f2 !important;background-image: linear-gradient(92deg, #0061f2 0%, rgba(105, 0, 199, .8) 100%) !important;">

                    <!-- Sidebar Toggle (Topbar) -->
                    <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                        <i class="fa fa-bars"></i>
                    </button>

                    <!-- Topbar Search -->
                    <form
                        class="d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search">
                        <div class="input-group">
                            <input type="text" class="form-control bg-light border-0 small" placeholder="Search for..."
                                aria-label="Search" aria-describedby="basic-addon2">
                            <div class="input-group-append">
                                <button class="btn btn-primary" type="button">
                                    <i class="fas fa-search fa-sm"></i>
                                </button>
                            </div>
                        </div>
                    </form>

                    <!-- Topbar Navbar -->
                    <ul class="navbar-nav ml-auto">

                        <!-- Nav Item - Search Dropdown (Visible Only XS) -->
                        <li class="nav-item dropdown no-arrow d-sm-none">
                            <a class="nav-link dropdown-toggle" href="#" id="searchDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-search fa-fw"></i>
                            </a>
                            <!-- Dropdown - Messages -->
                            <div class="dropdown-menu dropdown-menu-right p-3 shadow animated--grow-in"
                                aria-labelledby="searchDropdown">
                                <form class="form-inline mr-auto w-100 navbar-search">
                                    <div class="input-group">
                                        <input type="text" class="form-control bg-light border-0 small"
                                            placeholder="Search for..." aria-label="Search"
                                            aria-describedby="basic-addon2">
                                        <div class="input-group-append">
                                            <button class="btn btn-primary" type="button">
                                                <i class="fas fa-search fa-sm"></i>
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </li>

                        <!-- Nav Item - Alerts -->
                        <li class="nav-item dropdown no-arrow mx-1">
                            <a class="nav-link dropdown-toggle" href="#" id="alertsDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-bell fa-fw"></i>
                                <!-- Counter - Alerts -->
                                <span class="badge badge-danger badge-counter">3+</span>
                            </a>
                            <!-- Dropdown - Alerts -->
                            <div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                aria-labelledby="alertsDropdown">
                                <h6 class="dropdown-header">
                                    Alerts Center
                                </h6>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="mr-3">
                                        <div class="icon-circle bg-primary">
                                            <i class="fas fa-file-alt text-white"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="small text-gray-500">December 12, 2019</div>
                                        <span class="font-weight-bold">A new monthly report is ready to download!</span>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="mr-3">
                                        <div class="icon-circle bg-success">
                                            <i class="fas fa-donate text-white"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="small text-gray-500">December 7, 2019</div>
                                        $290.29 has been deposited into your account!
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="mr-3">
                                        <div class="icon-circle bg-warning">
                                            <i class="fas fa-exclamation-triangle text-white"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="small text-gray-500">December 2, 2019</div>
                                        Spending Alert: We've noticed unusually high spending for your account.
                                    </div>
                                </a>
                                <a class="dropdown-item text-center small text-gray-500" href="#">Show All Alerts</a>
                            </div>
                        </li>

                        <!-- Nav Item - Messages -->
                        <li class="nav-item dropdown no-arrow mx-1">
                            <a class="nav-link dropdown-toggle" href="#" id="messagesDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-envelope fa-fw"></i>
                                <!-- Counter - Messages -->
                                <span class="badge badge-danger badge-counter">7</span>
                            </a>
                            <!-- Dropdown - Messages -->
                            <div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                aria-labelledby="messagesDropdown">
                                <h6 class="dropdown-header">
                                    Message Center
                                </h6>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="img/undraw_profile_1.svg"
                                            alt="...">
                                        <div class="status-indicator bg-success"></div>
                                    </div>
                                    <div class="font-weight-bold">
                                        <div class="text-truncate">Hi there! I am wondering if you can help me with a
                                            problem I've been having.</div>
                                        <div class="small text-gray-500">Emily Fowler · 58m</div>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="img/undraw_profile_2.svg"
                                            alt="...">
                                        <div class="status-indicator"></div>
                                    </div>
                                    <div>
                                        <div class="text-truncate">I have the photos that you ordered last month, how
                                            would you like them sent to you?</div>
                                        <div class="small text-gray-500">Jae Chun · 1d</div>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="img/undraw_profile_3.svg"
                                            alt="...">
                                        <div class="status-indicator bg-warning"></div>
                                    </div>
                                    <div>
                                        <div class="text-truncate">Last month's report looks great, I am very happy with
                                            the progress so far, keep up the good work!</div>
                                        <div class="small text-gray-500">Morgan Alvarez · 2d</div>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="https://source.unsplash.com/Mv9hjnEUHR4/60x60"
                                            alt="...">
                                        <div class="status-indicator bg-success"></div>
                                    </div>
                                    <div>
                                        <div class="text-truncate">Am I a good boy? The reason I ask is because someone
                                            told me that people say this to all dogs, even if they aren't good...</div>
                                        <div class="small text-gray-500">Chicken the Dog · 2w</div>
                                    </div>
                                </a>
                                <a class="dropdown-item text-center small text-gray-500" href="#">Read More Messages</a>
                            </div>
                        </li>

                        <div class="topbar-divider d-none d-sm-block"></div>

                        <!-- Nav Item - User Information -->
                        <li class="nav-item dropdown no-arrow">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="mr-2 d-none d-lg-inline text-white small">Usuario GPEM</span>
                                <img class="img-profile rounded-circle"
                                    src="img/undraw_profile.svg">
                            </a>
                            <!-- Dropdown - User Information -->
                            <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                aria-labelledby="userDropdown">
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Profile
                                </a>
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Settings
                                </a>
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-list fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Activity Log
                                </a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">
                                    <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Logout
                                </a>
                            </div>
                        </li>
                    </ul>
                </nav>
                <!-- End of Topbar -->

                <!-- Begin Page Content -->
                <div class="container-fluid">

                  <div class="p-3 mb-2 header text-uppercase text-center">
                    <h1>Sistema de Control de Asistencias</h1>
                  </div>
              
                  <div id='mostrar'></div>

                  <main class="contenedor grid-lg">

                    <div class="card mb-3 grid-2 dni-grid">
                      <h2 class="titulo-card">Documento de identidad</h2>
                      <div class="form-group">
                        <label for="nroDni">Nro. DNI</label>
                        <input type="tel" class="form-control pt-4 pb-4" id="nroDni">
                      </div>
                      <div class="form-group text-center">
                        <button type="button" class="btn btn-primary text-uppercase p-3 m-3" id="btnAsistencia">Asistencia</button>
                        <button type="button" class="btn btn-danger text-uppercase p-3" id="btnRefrigerio">Refrigerio</button>
                      </div>
                    </div>
                    
                    <div class="card mb-3 grid-2 informacion-grid">
                      <h2 class="titulo-card">Información del usuario</h2>               
                      <div class="contenedor-foto grid-foto">
                        <img src="img/foto.png" alt="Foto del usuario">
                      </div>
                      <div class="form-group grid-codigo flex-dato">
                        <label class="label-dato" for="codigo">Código</label>
                        <input type="text" class="form-control pt-4 pb-4" id="codigo" disabled>
                      </div>
                      <div class="form-group grid-nombre flex-dato">
                        <label class="label-dato" for="nombre">Nombres</label>
                        <input type="text" class="form-control pt-4 pb-4" id="nombre" disabled>
                      </div>
                      <div class="form-group grid-apellido flex-dato">
                        <label class="label-dato" for="apellido">Apellido</label>
                        <input type="text" class="form-control pt-4 pb-4" id="apellido" disabled>
                      </div>
                      <div class="form-group grid-dni flex-dato">
                        <label class="label-dato" for="dni">DNI</label>
                        <input type="text" class="form-control pt-4 pb-4" id="dni" disabled>
                      </div>
                      <div class="form-group grid-cargo flex-dato">
                        <label class="label-dato" for="cargo">Cargo</label>
                        <input type="text" class="form-control pt-4 pb-4" id="cargo" disabled>
                      </div>
                    </div>
                    
                    <!-- Sección registro de actividades -->
                    <div class="card mb-3">
                        <h2 class="titulo-card">Registro de actividades</h2>
                        
                        <div class="row">
                          <div class="form-group col-md-6 pl-4 pr-4">
                            <label for="entrada-fecha">Fecha :</label>
                            <input type="text" class="form-control pt-4 pb-4" id="entrada-fecha" value="2024-07-09" disabled>
                          </div>
  
                          <div class="form-group col-md-6 pl-4 pr-4">
                            <label for="entrada-horario">Horario :</label>
                            <input type="text" class="form-control pt-4 pb-4" id="horario" value="08:00 A 18:00" disabled>
                          </div>
                        </div>
                        
                        <div class="row p-2">
                          <div class="col-6 col-md-3 col-lg-3 mb-4">
                              <div class="card bg-primary text-white shadow">
                                  <div class="card-body" id="btnIngresoLabores">
                                      Ingreso labores
                                  </div>
                              </div>
                          </div>
                          <div class="col-6 col-md-3 col-lg-3 mb-4">
                              <div class="card bg-success text-white shadow">
                                  <div class="card-body inactivo" id="btnIngresoRefrigerio">
                                      Ingreso refrigerio
                                  </div>
                              </div>
                          </div>
                          <div class="col-6 col-md-3 col-lg-3 mb-4">
                              <div class="card bg-info text-white shadow">
                                  <div class="card-body inactivo" id="btnSalidaRefrigerio">
                                      Salida refrigerio
                                  </div>
                              </div>
                          </div>
                          <div class="col-6 col-md-3 col-lg-3 mb-4">
                              <div class="card bg-warning text-white shadow">
                                  <div class="card-body inactivo" id="btnSalidaLabores">
                                      Salida labores
                                  </div>
                              </div>
                          </div>
                      </div>
                    </div>
    
                    <!-- Hora y Fecha Actual -->
                    <div class="card text-center p-4 mb-3 hora_fecha-grid">
                      <div class="form-group"> 
                        <time id="horaActual">12:51:00 Hrs.</time>
                      </div>
                      <div class="form-group">
                        <time id="fechaActual">Miercoles, 10 de Junio de 2024</time>
                      </div>
                    </div>
                    
                    <div class="card mb-3 geolocalizacion-grid">
                        <h2 class="titulo-card">Geolocalización de ingreso</h2>
                        <div class="form-group">
                            <label for="latitud">Latitud :</label>
                            <input class="form-control dato-gps" id="latitud" disabled/>
                        </div>
                        <div class="form-group">
                          <label for="longitud">Longitud :</label>
                          <input class="form-control dato-gps" id="longitud" disabled/>
                        </div>
                         <div class="form-group">
                            <label for="direccion">Dirección :</label>
                            <textarea class="form-control" name="" id="direccion"></textarea>
                            
                        </div>
                        <div id='mapa-container'>
                          <div id="mapa"></div>
                        </div>
                      </div>
                  </main>

                </div>
                <!-- /.container-fluid -->

            </div>
            <!-- End of Main Content -->
            <!-- Footer -->
            <footer class="text-center">
              <p>
                  Desarrollado por
                  <small rel="noopener noreferrer">
                  GPEM S.A.C
                  </small>
                  &copy; 2024
              </p>
            </footer>
            <!-- End of Footer -->
        </div>
        <!-- End of Content Wrapper -->
    </div>
    <!-- End of Page Wrapper -->
    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    
    <script>
        // OBJETOS QUE SIMULAN CONSUMO DE BASE DE DATOS
        const personal = [
            {
                pers_codigo: 1,
                idcargo:1,
                idarea:1,
                pers_nombres: "Fernando Edilberto",
                pers_apellidos: "Hernández Gonzales",
                pers_alias:"fernando",
                pers_dni: "50505050",
                pers_fechaIngreso: "2024-01-01",
                pers_fechaNac: "1980-01-01",
                pers_direccion: "Dirección 100",
                pers_telefono:"989898989",
                pers_telefono2:"979798987",
                pers_fechaCese:"2024-02-10",
                pers_motivoCese:"Solicitud",
                pers_estado:2,
                pers_nivel:null,
                bib_acceso: 1,
                ccrh:0,
                pers_actualizacion:null
            },
            {
                pers_codigo: 2,
                idcargo:2,
                idarea:1,
                pers_nombres: "Maria Fernanda",
                pers_apellidos: "Perez Lopez",
                pers_alias:"maria",
                pers_dni: "40404040",
                pers_fechaIngreso: "2024-02-01",
                pers_fechaNac: "1988-02-01",
                pers_direccion: "Dirección 200",
                pers_telefono:"979797979",
                pers_telefono2:"960606060",
                pers_fechaCese:"2024-06-10",
                pers_motivoCese:"Solicitud",
                pers_estado:2,
                pers_nivel:null,
                bib_acceso: 1,
                ccrh:0,
                pers_actualizacion:null
            }
        ]

        const marcaciones=[
            {
                idmarcacion:1,
                idpersonal:1,
                idturno:1,
                fecha:"2024-06-13",
                condicion:1,
                turnoinicio: "08:00:00",
                turnofinal:"18:00:00",
                programacion1:"2024-06-13 08:00:00",
                programacion2:"2024-06-13 18:00:00",
                asistencia1:null,
                asistencia2:null,
                desayuno1:null,
                desayuno2:null,
                refrigerio1:null,
                refrigerio2:null,
                tecnicosino:0,
                estado:0,
                observacion:null,
                ccnivel:51,
                actualizacion:null,
                gps_direccion:null,
                gps_longitud:null,
                gps_latitud:null
            },
            {
                idmarcacion:2,
                idpersonal:2,
                idturno:1,
                fecha:"2024-06-13",
                condicion:1,
                turnoinicio: "08:00:00",
                turnofinal:"18:00:00",
                programacion1:"2024-06-13 08:00:00",
                programacion2:"2024-06-13 18:00:00",
                asistencia1:null,
                asistencia2:null,
                desayuno1:null,
                desayuno2:null,
                refrigerio1:null,
                refrigerio2:null,
                tecnicosino:0,
                estado:0,
                observacion:null,
                ccnivel:51,
                actualizacion:null,
                gps_direccion:null,
                gps_longitud:null,
                gps_latitud:null
            }
        ]

        const areas =[
            {
                idarea: 1,
                area: "Sistemas",
                estado: 2,
                usuario: null
            },
            {
                idarea: 2,
                area: "Administracion",
                estado: 2,
                usuario: null
            }
        ]

        const cargos =[
            {
                idcargo: 1,
                idarea : 1,
                cargo : "Programador",
                estado: 2,
                usuario:null
            },
            {
                idcargo: 2,
                idarea : 1,
                cargo : "Analista TI",
                estado: 2,
                usuario:null
            }
        ]

        const turnos =[
            {
                idturno : 1,
                turno :"diurno",
                idturnomtn : 0,
                horainicio : "08:00:00",
                horafin : "18:00:00",
                cambiodia : 0,
                tipo : 0,
                bancohrs : 0,
                estado : 2,
                actualizacion: 1
            }
        ];


        const navegacionFija = () => {
            const headerFijo = document.querySelector('#header');
            const observer = new IntersectionObserver((entries) => {
                if (entries[0].isIntersecting) {
                headerFijo.classList.remove('fijo');
                } else {
                headerFijo.classList.add('fijo');
                }
            });
            observer.observe(document.querySelector('#mostrar'));
        };
        navegacionFija();



        // FUNCIÓN QUE NO PERMITE INGRESO DE CARACTERES NO NÚMERICOS EN EL CAMPO DNI     
        const restricText = (idInput) =>{
            document.querySelector(idInput).addEventListener("input", function(event) {
                let value = event.target.value;
                event.target.value = value.replace(/\D/g, "");
            });
        }
        // LLAMANDO FUNCIÓN
        restricText("#nroDni");

        // FUNCIÓN QUE LIMITA INGRESO DE DÍGITOS EN EL INPUT
        const limitInputToDigits = (inputSelector, maxLength) => {
            document.querySelector(inputSelector).addEventListener('input', function (e) {
                this.value = this.value.replace(/\D/g, '').slice(0, maxLength);
            });
        }
        // LLAMANDO FUNCIÓN
        limitInputToDigits('#nroDni', 8);

        
        //FUNCIÓN PARA OBTENER INFO DE COLABORADOR POR SU 'ID' 
        const getPersonalDetails = (idPersonal) => {
            const person = personal.find(p => p.pers_codigo === idPersonal);
            if (!person) {
                return null;
                console.log("El ID no está registrado en la base de datos"); 
            }
            const cargo = cargos.find(c => c.idcargo === person.idcargo);
            const area = areas.find(a => a.idarea === person.idarea);
            const marcacion = marcaciones.filter(m => m.idpersonal === idPersonal);

            return { 
                ...person,
                cargo: cargo ? cargo.cargo : null,
                area: area ? area.area : null,
                marcaciones: marcacion
            };
        }

        // FUNCIÓN PARA OBTENER EL 'ID' DE COLABORADOR POR SU DNI
        const getIdByDni = (nroDni) => {
            const person = personal.find(p => p.pers_dni === nroDni);
            return person ? person.pers_codigo : null;
        }

        // FUNCIÓN PARA OBTENER INFORMACIÓN DE COLABORADOR POR DNI
        const consultarDni = () => {
            const nroDni = document.querySelector('#nroDni').value;
            // VALIDACIONES
            if (nroDni === '') {
                alert('Por favor ingrese el número de DNI.');
                console.log('Por favor ingrese el número de DNI.');
                return;
            }
            if (nroDni.length !== 8 || !/^\d{8}$/.test(nroDni)) {
                alert('El DNI debe contener exactamente 8 dígitos.');
                document.querySelector('#nroDni').value = ''; 
                return false;
            }
            // OBTENER EL 'ID' DE COLABORADOR POR DNI
            const idPersonal = getIdByDni(nroDni);
            if (!idPersonal) {
                alert('El DNI ingresado no existe.');
                console.log('El DNI ingresado no existe.');
                document.querySelector('#nroDni').value = ''; 
                return;
            }
            // OBTENER DETALLES DEL COLABORADOR POR SU 'ID' Y LUEGO CARGAR EN FORMULARIO
            const detalleColaborador = getPersonalDetails(idPersonal);
            
            if (detalleColaborador) {
                document.getElementById('codigo').value = detalleColaborador.pers_codigo;
                document.getElementById('nombre').value = detalleColaborador.pers_nombres;
                document.getElementById('apellido').value = detalleColaborador.pers_apellidos;
                document.getElementById('dni').value = detalleColaborador.pers_dni;
                document.getElementById('cargo').value = detalleColaborador.cargo;

                // Habilitar botones según las marcaciones o el estado del colaborador (implementación futura)
                console.log(detalleColaborador);
            }
        }

        // FUNCIÓN QUE PERMITE BUSCAR SI EXISTE DNI PRESIONANDO ENTER
        const searchByPressingEnter = (idSelector, metodo)=>{
            document.querySelector(idSelector).addEventListener('change', metodo);
        }
        // LLAMANDO FUNCIÓN
        searchByPressingEnter('#nroDni',consultarDni);

        // FUNCIÓN QUE RECIBE UN ARRAY DE LOS ID DE LOS INPUTS Y LOS LIMPIA
        const clearInputs = (inputIds) => {
            inputIds.forEach(id => {
                const element = document.querySelector(`#${id}`);
                if (element) {
                    element.value = "";
                }
            });
        };

        // FUNCIÓN QUE LLAME A LA FUNCION 'clearInputs' Y COLOCA FOCO EN INPUT DEL DNI 
        const clearDetailsPerson = () => {
            clearInputs(['codigo', 'nombre', 'apellido', 'dni', 'cargo', 'nroDni']);
            document.getElementById('nroDni').focus();
        };



        // BOTONES PRINCIPALES
        const btnAsistencia = document.querySelector('#btnAsistencia');
        const btnRefrigerio = document.querySelector('#btnRefrigerio');
        
        // BOTONES PARA FUNCIONALIDAS DE MODAL
        const modal = document.getElementById("modal");
        
        // INICIALIZANDO MODAL EN NONE.
        modal.style.display = "none";

        // FUNCIÓN PARA MOSTRAR/OCULTAR BOTONES
        const toggleButtons = (ingresoClass, salidaClass, show) => {
            const action = show ? 'remove' : 'add';
            document.querySelector(ingresoClass).classList[action]('hidden');
            document.querySelector(salidaClass).classList[action]('hidden');
        }

        // FUNCIÓN PARA REMOVER LA CLASE 'hidden' DE LOS BOTONES
        const removeHiddenClass = () => {
            const hiddenButtons = document.querySelectorAll('.hidden');
            hiddenButtons.forEach(button => button.classList.remove('hidden'));
        }

        // FUNCIÓN QUE AGREGA ATTRIBUTE 'disabled' A ELEMENTO QUE SE LE PASA SU 'Id'
        const setAttributeButton = (id) => {
            document.querySelector(id).setAttribute("disabled", "disabled");
        }

        // FUNCIÓN PARA BOTONES DE MODAL SI PRESIONAS ASISTENCIA Ó REFRIGERIO  
        const handleButtonClick = (buttonType) => {
            const nroDni = document.querySelector('#nroDni').value.trim();
            if (nroDni === '') {
                alert('NO SE RECONOCE EL DNI\nVerifique antes de continuar')
                console.log('NO SE RECONOCE EL DNI\nVerifique antes de continuar');
                return null;
            }
            
            modal.style.display = 'flex';

            if (buttonType === 'asistencia') {
                toggleButtons('.boton-ingreso-ref', '.boton-salida-ref', false);
                toggleButtons('.boton-ingreso-lab', '.boton-salida-lab', true);
            } 
            if (buttonType === 'refrigerio') {
                toggleButtons('.boton-ingreso-lab', '.boton-salida-lab', false);
                toggleButtons('.boton-ingreso-ref', '.boton-salida-ref', true);
            }
        };

        // EVENTO CLICK EN FUNCIÓN 'handleButtonClick' PARA ASISTENCIA
        btnAsistencia.addEventListener('click', () => {
            handleButtonClick('asistencia')
        });

        // EVENTO CLICK EN FUNCIÓN 'handleButtonClick' PARA REFRIGERIO
        btnRefrigerio.addEventListener('click', () => {
            handleButtonClick('refrigerio')
        });

        // FUNCIÓN PARA CERRAR MODAL Y LIMPIAR DETALLES DE COLABORADOR
        const closeModalAndClearDetails = () => {
            modal.style.display = "none";
            clearDetailsPerson(); 
        };

        // ASIGNANDO EVENTOS PARA CERRA MODAL
        document.addEventListener('click', (event) => {
            if (event.target.classList.contains('cerrar') || event.target === modal) {
                closeModalAndClearDetails();
            }
        });

        // FUNCIÓN PARA OBTENER FECHA CORTA DE REGISTRO DE ACTIVIDADES
        const obtenerFechaActualCorta = () => {
            const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
            return new Date().toLocaleDateString('es-ES', options);
        }

        // FUNCIÓN QUE MUESTRA BOTÓN DE INGRESO-SALIDA LABORES E INGRESO-SALIDA REFRIGERIO
        const removeInactiveClass = (id) => {
            document.querySelector(id).classList.remove('inactivo'); 
        }

        // FUNCIÓN QUE MANEJA EVENTO CLICK PARA LOS BOTONES DEL MODAL
        const handleModalButtonClick = (event) => {
            const buttonId = event.target.id;
            console.log(buttonId);

            switch (buttonId) {
                case 'modalBtnIngresoLabores':
                    let currentDate = document.querySelector("#entrada-fecha");
                    currentDate.value = obtenerFechaActualCorta();
                    // AGREGAR LÓGICA DE NEGOCIO
                    removeInactiveClass("#btnIngresoLabores");
                    break;
                case 'modalBtnSalidaLabores':
                    // AGREGAR LÓGICA DE NEGOCIO
                    removeInactiveClass("#btnSalidaLabores");
                    break;
                case 'modalBtnIngresoRefrigerio':
                    // AGREGAR LÓGICA DE NEGOCIO
                    removeInactiveClass("#btnIngresoRefrigerio");
                    break;
                case 'modalBtnSalidaRefrigerio':
                    // AGREGAR LÓGICA DE NEGOCIO
                    removeInactiveClass("#btnSalidaRefrigerio");
                    break;
                default:
                    return; // SALIR
            }
            closeModalAndClearDetails();
        };

        // CONFIGURANDO UN SOLO CLICK PARA EL MODAL
        modal.addEventListener('click', handleModalButtonClick);


        /*  ===========================================================
            MOSTRAR HORA Y FECHA ACTUAL (DIA SENANA, DIA, MES Y AÑO) : 
            ===========================================================
        */ 
        // FUNCIÓN PARA OBTENER HORA ACTUAL EN FORMATO AM/PM
        const obtenerHoraActual = () => {
            const ahora = new Date();
            let horas = ahora.getHours();
            let minutos = ahora.getMinutes();
            const ampm = horas >= 12 ? 'p.m.' : 'a.m.';
            horas = horas % 12;
            horas = horas ? horas : 12; // las 0 horas se convierten a 12
            minutos = minutos < 10 ? '0' + minutos : minutos;
            return horas + ':' + minutos + ' ' + ampm;
        }

        // FUNCIÓN PARA OBTENER LA FECHA ACTUAL EN FORMATO: DÍAS DE LA SEMANA, DÍAS, MES Y AÑO
        const obtenerFechaActual = () => {
            const opcionesFecha = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            return new Date().toLocaleDateString('es-ES', opcionesFecha);
        }

        // FUNCIÓN PARA LA HORA Y FECHA ACTUAL CADA DE SEGUNDO
        const actualizarHoraFecha = () => {
            const horaActualElemento = document.getElementById('horaActual');
            const fechaActualElemento = document.getElementById('fechaActual');

            horaActualElemento.textContent = obtenerHoraActual();
            fechaActualElemento.textContent = obtenerFechaActual();
        }
        // LLAMANDO FUNCIÓN
        actualizarHoraFecha();

        // MÉTODO QUE ACTUALIZA LA FUNCIÓN 'actualizarHoraFecha' CADA SEGUNDO
        setInterval(actualizarHoraFecha, 1000);

        //GEOLOCALIZACIÓN
        async function obtenerDireccion(latitud, longitud) {
            const url = `https://nominatim.openstreetmap.org/reverse?lat=${latitud}&lon=${longitud}&format=json`;

            try {
                const response = await fetch(url);
                const data = await response.json();
                const address = data.display_name;
                document.getElementById("direccion").textContent = address;
                
                document.querySelector('#mapa').innerHTML = `
                <iframe 
                    src="https://www.google.com/maps/embed?pb=!1m24!1m12!1m3!1d3903.8292716492524!2d${longitud}!3d${latitud}!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!4m9!3e6!4m3!3m2!1d${latitud}!2d${longitud}!4m3!3m2!1d${latitud}!2d${longitud}!5e0!3m2!1ses-419!2spe!4v1717531069082!5m2!1ses-419!2spe" 
                    width=100% 
                    height=100% 
                    style="border:0;" 
                    allowfullscreen="" 
                    loading="lazy" 
                    referrerpolicy="no-referrer-when-downgrade">
                </iframe>
            `;
            } catch (error) {
                console.error('Error al obtener la dirección:', error);
            }
        }

        async function obtenerGeolocalizacion() {
            if (navigator.geolocation) {
                try {
                    const position = await new Promise((resolve, reject) => {
                        navigator.geolocation.getCurrentPosition(resolve, reject);
                    });
                    const latitud = position.coords.latitude;
                    const longitud = position.coords.longitude;

                    document.getElementById("latitud").textContent = latitud;
                    document.getElementById("longitud").textContent = longitud;

                    await obtenerDireccion(latitud, longitud);

                    // Verificación de las coordenadas
                    console.log(`Latitud: ${latitud}, Longitud: ${longitud}`);

                } catch (error) {
                    // Manejar errores
                    switch (error.code) {
                        case error.PERMISSION_DENIED:
                            alert("El usuario ha denegado la solicitud de geolocalización.");
                            break;
                        case error.POSITION_UNAVAILABLE:
                            alert("La información de ubicación no está disponible.");
                            break;
                        case error.TIMEOUT:
                            alert("Se ha agotado el tiempo para obtener la ubicación del usuario.");
                            break;
                        case error.UNKNOWN_ERROR:
                            alert("Se ha producido un error desconocido.");
                            break;
                    }
                }
            } else {
                alert("Geolocalización no soportada por este navegador.");
            }
        }
        obtenerGeolocalizacion();
    </script>

    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin-2.min.js"></script>

    <!-- Page level plugins -->
    <script src="vendor/chart.js/Chart.min.js"></script>

    <!-- Page level custom scripts -->
    <script src="js/demo/chart-area-demo.js"></script>
    <script src="js/demo/chart-pie-demo.js"></script>

</body>

</html>